{"moduleDefinition":{"range":[1,1,1,44],"value":{"type":"normal","normal":{"moduleName":{"range":[1,8,1,24],"value":["MatchingBrackets"]},"exposingList":{"range":[1,25,1,44],"value":{"type":"explicit","explicit":[{"range":[1,35,1,43],"value":{"type":"function","function":{"name":"isPaired"}}}]}}}}},"imports":[],"declarations":[{"range":[4,1,11,31],"value":{"type":"function","function":{"documentation":null,"signature":{"range":[4,1,4,26],"value":{"name":{"range":[4,1,4,9],"value":"isPaired"},"typeAnnotation":{"range":[4,12,4,26],"value":{"type":"function","function":{"left":{"range":[4,12,4,18],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[4,12,4,18],"value":{"moduleName":[],"name":"String"}},"args":[]}}},"right":{"range":[4,22,4,26],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[4,22,4,26],"value":{"moduleName":[],"name":"Bool"}},"args":[]}}}}}}}},"declaration":{"range":[5,1,11,31],"value":{"name":{"range":[5,1,5,9],"value":"isPaired"},"arguments":[{"range":[5,10,5,15],"value":{"type":"var","var":{"value":"input"}}}],"expression":{"range":[6,5,11,31],"value":{"type":"case","case":{"cases":[{"pattern":{"range":[7,9,7,18],"value":{"type":"named","named":{"qualified":{"moduleName":[],"name":"Err"},"patterns":[{"range":[7,13,7,18],"value":{"type":"var","var":{"value":"error"}}}]}}},"expression":{"range":[8,13,8,18],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"False"}}}},{"pattern":{"range":[10,9,10,17],"value":{"type":"named","named":{"qualified":{"moduleName":[],"name":"Ok"},"patterns":[{"range":[10,12,10,17],"value":{"type":"var","var":{"value":"value"}}}]}}},"expression":{"range":[11,13,11,31],"value":{"type":"application","application":[{"range":[11,13,11,25],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["List"],"name":"isEmpty"}}},{"range":[11,26,11,31],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"value"}}}]}}}],"expression":{"range":[6,10,6,62],"value":{"type":"application","application":[{"range":[6,10,6,22],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["String"],"name":"foldl"}}},{"range":[6,23,6,41],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"stackFunctionality"}}},{"range":[6,42,6,56],"value":{"type":"parenthesized","parenthesized":{"range":[6,43,6,55],"value":{"type":"application","application":[{"range":[6,43,6,52],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"Ok"}}},{"range":[6,53,6,55],"value":{"type":"list","list":[]}}]}}}},{"range":[6,57,6,62],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"input"}}}]}}}}}}}}}},{"range":[21,1,23,54],"value":{"type":"function","function":{"documentation":null,"signature":{"range":[21,1,21,84],"value":{"name":{"range":[21,1,21,19],"value":"stackFunctionality"},"typeAnnotation":{"range":[21,22,21,84],"value":{"type":"function","function":{"left":{"range":[21,22,21,26],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,22,21,26],"value":{"moduleName":[],"name":"Char"}},"args":[]}}},"right":{"range":[21,30,21,84],"value":{"type":"function","function":{"left":{"range":[21,30,21,55],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,30,21,36],"value":{"moduleName":[],"name":"Result"}},"args":[{"range":[21,37,21,43],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,37,21,43],"value":{"moduleName":[],"name":"String"}},"args":[]}}},{"range":[21,44,21,55],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,45,21,49],"value":{"moduleName":[],"name":"List"}},"args":[{"range":[21,50,21,54],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,50,21,54],"value":{"moduleName":[],"name":"Char"}},"args":[]}}}]}}}]}}},"right":{"range":[21,59,21,84],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,59,21,65],"value":{"moduleName":[],"name":"Result"}},"args":[{"range":[21,66,21,72],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,66,21,72],"value":{"moduleName":[],"name":"String"}},"args":[]}}},{"range":[21,73,21,84],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,74,21,78],"value":{"moduleName":[],"name":"List"}},"args":[{"range":[21,79,21,83],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[21,79,21,83],"value":{"moduleName":[],"name":"Char"}},"args":[]}}}]}}}]}}}}}}}}}}},"declaration":{"range":[22,1,23,54],"value":{"name":{"range":[22,1,22,19],"value":"stackFunctionality"},"arguments":[{"range":[22,20,22,27],"value":{"type":"var","var":{"value":"bracket"}}},{"range":[22,28,22,40],"value":{"type":"var","var":{"value":"bracketStack"}}}],"expression":{"range":[23,5,23,54],"value":{"type":"application","application":[{"range":[23,5,23,19],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"andThen"}}},{"range":[23,20,23,41],"value":{"type":"parenthesized","parenthesized":{"range":[23,21,23,40],"value":{"type":"application","application":[{"range":[23,21,23,32],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"updateStack"}}},{"range":[23,33,23,40],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracket"}}}]}}}},{"range":[23,42,23,54],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracketStack"}}}]}}}}}}},{"range":[25,1,51,1],"value":{"type":"function","function":{"documentation":null,"signature":{"range":[25,1,25,61],"value":{"name":{"range":[25,1,25,12],"value":"updateStack"},"typeAnnotation":{"range":[25,15,25,61],"value":{"type":"function","function":{"left":{"range":[25,15,25,19],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,15,25,19],"value":{"moduleName":[],"name":"Char"}},"args":[]}}},"right":{"range":[25,23,25,61],"value":{"type":"function","function":{"left":{"range":[25,23,25,32],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,23,25,27],"value":{"moduleName":[],"name":"List"}},"args":[{"range":[25,28,25,32],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,28,25,32],"value":{"moduleName":[],"name":"Char"}},"args":[]}}}]}}},"right":{"range":[25,36,25,61],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,36,25,42],"value":{"moduleName":[],"name":"Result"}},"args":[{"range":[25,43,25,49],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,43,25,49],"value":{"moduleName":[],"name":"String"}},"args":[]}}},{"range":[25,50,25,61],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,51,25,55],"value":{"moduleName":[],"name":"List"}},"args":[{"range":[25,56,25,60],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[25,56,25,60],"value":{"moduleName":[],"name":"Char"}},"args":[]}}}]}}}]}}}}}}}}}}},"declaration":{"range":[26,1,51,1],"value":{"name":{"range":[26,1,26,12],"value":"updateStack"},"arguments":[{"range":[26,13,26,20],"value":{"type":"var","var":{"value":"bracket"}}},{"range":[26,21,26,33],"value":{"type":"var","var":{"value":"bracketStack"}}}],"expression":{"range":[27,5,51,1],"value":{"type":"ifBlock","ifBlock":{"clause":{"range":[27,8,27,34],"value":{"type":"application","application":[{"range":[27,8,27,26],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"isStartingBrackets"}}},{"range":[27,27,27,34],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracket"}}}]}},"then":{"range":[28,9,28,45],"value":{"type":"application","application":[{"range":[28,9,28,18],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"Ok"}}},{"range":[28,19,28,21],"value":{"type":"operator","operator":"<|"}},{"range":[28,22,28,29],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracket"}}},{"range":[28,30,28,32],"value":{"type":"operator","operator":"::"}},{"range":[28,33,28,45],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracketStack"}}}]}},"else":{"range":[30,10,51,1],"value":{"type":"ifBlock","ifBlock":{"clause":{"range":[30,13,30,37],"value":{"type":"application","application":[{"range":[30,13,30,29],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"isEndingBrackets"}}},{"range":[30,30,30,37],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracket"}}}]}},"then":{"range":[31,9,47,5],"value":{"type":"let","let":{"declarations":[{"range":[32,13,34,9],"value":{"type":"function","function":{"documentation":null,"signature":null,"declaration":{"range":[32,13,33,39],"value":{"name":{"range":[32,13,32,21],"value":"popValue"},"arguments":[],"expression":{"range":[33,17,33,39],"value":{"type":"application","application":[{"range":[33,17,33,26],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["List"],"name":"head"}}},{"range":[33,27,33,39],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracketStack"}}}]}}}}}}}],"expression":{"range":[35,9,47,5],"value":{"type":"case","case":{"cases":[{"pattern":{"range":[36,13,36,20],"value":{"type":"named","named":{"qualified":{"moduleName":[],"name":"Nothing"},"patterns":[]}}},"expression":{"range":[37,17,37,57],"value":{"type":"application","application":[{"range":[37,17,37,27],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"Err"}}},{"range":[37,28,37,57],"value":{"type":"literal","literal":"Nothing to pop off in stack"}}]}}},{"pattern":{"range":[39,13,39,19],"value":{"type":"named","named":{"qualified":{"moduleName":[],"name":"Just"},"patterns":[{"range":[39,18,39,19],"value":{"type":"var","var":{"value":"a"}}}]}}},"expression":{"range":[40,17,47,5],"value":{"type":"ifBlock","ifBlock":{"clause":{"range":[40,20,40,49],"value":{"type":"application","application":[{"range":[40,20,40,36],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracketToLookFor"}}},{"range":[40,37,40,38],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"a"}}},{"range":[40,39,40,41],"value":{"type":"operator","operator":"=="}},{"range":[40,42,40,49],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracket"}}}]}},"then":{"range":[41,21,41,58],"value":{"type":"application","application":[{"range":[41,21,41,30],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"Ok"}}},{"range":[41,31,41,33],"value":{"type":"operator","operator":"<|"}},{"range":[41,34,41,43],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["List"],"name":"drop"}}},{"range":[41,44,41,45],"value":{"type":"integer","integer":1}},{"range":[41,46,41,58],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracketStack"}}}]}},"else":{"range":[45,21,45,55],"value":{"type":"application","application":[{"range":[45,21,45,31],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"Err"}}},{"range":[45,32,45,55],"value":{"type":"literal","literal":"Brackets do not match"}}]}}}}}}],"expression":{"range":[35,14,35,22],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"popValue"}}}}}}}}},"else":{"range":[48,9,48,31],"value":{"type":"application","application":[{"range":[48,9,48,18],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":["Result"],"name":"Ok"}}},{"range":[48,19,48,31],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"bracketStack"}}}]}}}}}}}}}}}}},{"range":[51,1,53,46],"value":{"type":"function","function":{"documentation":null,"signature":{"range":[51,1,51,32],"value":{"name":{"range":[51,1,51,17],"value":"isEndingBrackets"},"typeAnnotation":{"range":[51,20,51,32],"value":{"type":"function","function":{"left":{"range":[51,20,51,24],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[51,20,51,24],"value":{"moduleName":[],"name":"Char"}},"args":[]}}},"right":{"range":[51,28,51,32],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[51,28,51,32],"value":{"moduleName":[],"name":"Bool"}},"args":[]}}}}}}}},"declaration":{"range":[52,1,53,46],"value":{"name":{"range":[52,1,52,17],"value":"isEndingBrackets"},"arguments":[{"range":[52,18,52,22],"value":{"type":"var","var":{"value":"char"}}}],"expression":{"range":[53,5,53,46],"value":{"type":"application","application":[{"range":[53,5,53,9],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[53,10,53,12],"value":{"type":"operator","operator":"=="}},{"range":[53,13,53,16],"value":{"type":"charLiteral","charLiteral":"}"}},{"range":[53,17,53,19],"value":{"type":"operator","operator":"||"}},{"range":[53,20,53,24],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[53,25,53,27],"value":{"type":"operator","operator":"=="}},{"range":[53,28,53,31],"value":{"type":"charLiteral","charLiteral":"]"}},{"range":[53,32,53,34],"value":{"type":"operator","operator":"||"}},{"range":[53,35,53,39],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[53,40,53,42],"value":{"type":"operator","operator":"=="}},{"range":[53,43,53,46],"value":{"type":"charLiteral","charLiteral":")"}}]}}}}}}},{"range":[56,1,58,46],"value":{"type":"function","function":{"documentation":null,"signature":{"range":[56,1,56,34],"value":{"name":{"range":[56,1,56,19],"value":"isStartingBrackets"},"typeAnnotation":{"range":[56,22,56,34],"value":{"type":"function","function":{"left":{"range":[56,22,56,26],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[56,22,56,26],"value":{"moduleName":[],"name":"Char"}},"args":[]}}},"right":{"range":[56,30,56,34],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[56,30,56,34],"value":{"moduleName":[],"name":"Bool"}},"args":[]}}}}}}}},"declaration":{"range":[57,1,58,46],"value":{"name":{"range":[57,1,57,19],"value":"isStartingBrackets"},"arguments":[{"range":[57,20,57,24],"value":{"type":"var","var":{"value":"char"}}}],"expression":{"range":[58,5,58,46],"value":{"type":"application","application":[{"range":[58,5,58,9],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[58,10,58,12],"value":{"type":"operator","operator":"=="}},{"range":[58,13,58,16],"value":{"type":"charLiteral","charLiteral":"{"}},{"range":[58,17,58,19],"value":{"type":"operator","operator":"||"}},{"range":[58,20,58,24],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[58,25,58,27],"value":{"type":"operator","operator":"=="}},{"range":[58,28,58,31],"value":{"type":"charLiteral","charLiteral":"["}},{"range":[58,32,58,34],"value":{"type":"operator","operator":"||"}},{"range":[58,35,58,39],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[58,40,58,42],"value":{"type":"operator","operator":"=="}},{"range":[58,43,58,46],"value":{"type":"charLiteral","charLiteral":"("}}]}}}}}}},{"range":[61,1,72,1],"value":{"type":"function","function":{"documentation":null,"signature":{"range":[61,1,61,32],"value":{"name":{"range":[61,1,61,17],"value":"bracketToLookFor"},"typeAnnotation":{"range":[61,20,61,32],"value":{"type":"function","function":{"left":{"range":[61,20,61,24],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[61,20,61,24],"value":{"moduleName":[],"name":"Char"}},"args":[]}}},"right":{"range":[61,28,61,32],"value":{"type":"typed","typed":{"moduleNameAndName":{"range":[61,28,61,32],"value":{"moduleName":[],"name":"Char"}},"args":[]}}}}}}}},"declaration":{"range":[62,1,72,1],"value":{"name":{"range":[62,1,62,17],"value":"bracketToLookFor"},"arguments":[{"range":[62,18,62,22],"value":{"type":"var","var":{"value":"char"}}}],"expression":{"range":[63,5,72,1],"value":{"type":"ifBlock","ifBlock":{"clause":{"range":[63,8,63,19],"value":{"type":"application","application":[{"range":[63,8,63,12],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[63,13,63,15],"value":{"type":"operator","operator":"=="}},{"range":[63,16,63,19],"value":{"type":"charLiteral","charLiteral":"{"}}]}},"then":{"range":[64,9,64,12],"value":{"type":"charLiteral","charLiteral":"}"}},"else":{"range":[66,10,72,1],"value":{"type":"ifBlock","ifBlock":{"clause":{"range":[66,13,66,24],"value":{"type":"application","application":[{"range":[66,13,66,17],"value":{"type":"functionOrValue","functionOrValue":{"moduleName":[],"name":"char"}}},{"range":[66,18,66,20],"value":{"type":"operator","operator":"=="}},{"range":[66,21,66,24],"value":{"type":"charLiteral","charLiteral":"("}}]}},"then":{"range":[67,9,67,12],"value":{"type":"charLiteral","charLiteral":")"}},"else":{"range":[70,9,70,12],"value":{"type":"charLiteral","charLiteral":"]"}}}}}}}}}}}}}],"comments":[{"range":[42,21,42,57],"value":"-- Matching bracket, return the rest"},{"range":[13,2,20,4],"value":"{- \n TLDR Andthen : if any of the updateStack function calls returns a Err, Err the whole thing.\n Long version: Use partial application to make a callback function that matches the function signature for andThen.\n Run the code with andthen, which first checks to see if Result is already an error, if it is, don't even\n bother running the callback function, just return the error.\n Otherwise run the callback function and return whatever that result happens to be.\n Result.andThen could already be taking in an error from a previous call, so it needs to check.\n -}"}]}